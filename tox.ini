[tox]
envlist = py, flake8, black, mypy, docs

[testenv]
description = Run tests with pytest under {basepython}
setenv =
    PYTHONPATH = {toxinidir}
deps =
    -r{toxinidir}/requirements/dev.txt
commands =
    pytest -vv --doctest-modules --cov=hl_gaps_pub --cov-report term-missing --cov-report xml --cov-report html tests

[testenv:flake8]
basepython = python3.10
deps =
  flake8
  flake8-blind-except
  flake8-debugger
  flake8-docstrings
  flake8-isort
  pep8-naming
skip_install = true
commands = flake8 hl_gaps_pub tests

[testenv:black]
basepython = python3.10
deps =
  black
skip_install = true
commands =
  black --check hl_gaps_pub tests

[testenv:mypy]
basepython = python3.10
deps =
  mypy
skip_install = true
commands =
  mypy --config-file pyproject.toml hl_gaps_pub

[testenv:docs]
description = Build the documentation
basepython = python3.10
deps =
    -r{toxinidir}/requirements/dev.txt
commands =
    sphinx-build -W -b html docs docs/_build/html